\chapter{Requirement Analysis}

In this chapter we discuss the requirements for the proxy being developed as a
part of this thesis. Those requirements build on the scope and premises
discussed in the introduction. To recap, these defining premesis were:

\begin{enumerate}
    \item Support both REST and Web service communication between machines connected in a DIL network.
    \item Work on top of the IP-layer.
    \item All optimization techniques must be placed in a proxy, and not in the Web service applications themselves.
\end{enumerate}

\section{HTTP Proxy}

The first requirement implies that our proxy must accept HTTP, as this is the
far most used Web service protocol. Our proxy must be able to accept a HTTP
requests from a Web service, forward it to the other proxy, which in turn
delivers it to the intended receiver. The communication between the proxies are
not required to be HTTP, but rather a protocol than deals with DIL networks in a
better way. However, since ultimately a HTTP request should be delivered to the
intended receiver, the HTTP properties must be retained. This means that the
proxy must preserve the HTTP Method and HTTP headers. Also, since REST is
payload agnostic, the proxy must be able to support different types of data
being sent through it(XML, JSON etc.).

Furthermore, the proxy must be able to handle the difficult network conditions
of DIL. The specific requirements are outlined in the following sections.

\section{Cope with DIL}

\subsection{Disconnected}

Support disconnects over a longer period of time. Previous work identified the
removal of end-to-end dependencies as important. By employing proxies, the
end-to-end dependency is instead between the client and the proxy locally.
However, the connection between the proxies over a DIL network can still be
lost. This means that the proxy must be able to maintain the connection with the
local application, while managing loss of connection with the other proxy. When
the connection are reestablished, the proxy should continue sending the data and
finally delivering a response back to the client.

This requires the proxy to have some sort of redeliver mechanism, which after a
time tries to retransmit the data. If still unsuccessful, the proxy waits an
amount of time before attempting again. This should be done indefinitely until
the connection is reestablished. One consideration about this is the risk of
overflowing the receiver. It is therefor common to use an exponential back off.
This mechanisms grants that the proxy tries frequently immediately after loss of
connection, but gradually tries more and more seldom. Different use cases may
require different parameters, so back-off and redeliver delay should be able to
alter via proxy configuration.

\subsection{Intermittent}

Handle brief disconnects. Same requirements as for disconnected. The proxy
should "hide" disconnects from the client.

\subsection{Limited}

It must handle very low data rates.

\section{Support optimization techniques}

\subsection{Compression}

In order to perform compression the proxy must be able to modify the payload of
the message. Due to security mechanisms that detect changes to the
payload(checksums), the payload must be restored back to its original form
before being forwarded to the final receiver.

\subsection{Proxy protocol communication}

One of the optimization techniques identified was the usage of alternative
protocols. The proxy should therefor support a sub set of them, and be easily
configured to use other protocols for testing purposes.

MQTT is pub/sub, unfit for our request/reply setup.

"Ren" TCP dropper vi fordi vi vet at den brekker fra tidligere forsøk.

UDP krever så mye tid å implementere at vi dropper det.


\section{Other considerations}

Since we're creating a proxy aimed for use in a military context, military
operational requirements are part of the requirements for this proxy. Mobile
units have to carry batteries with them and the capacity is therefore limited.
Advanced compression techniques may reduce the overhead, but also requires more
battery. This trade-off needs to be considered.


\section{Summary}

In this chapter we have discussed the requirements for our proxy, which are
summarized here:

\begin{enumerate}
    \item Receive and forward HTTP requests
    \item Retain HTTP request and response headers.
    \item Support GZIP compression of payload.
    \item Handle frequent disconnects.
    \item Handle disconnects over longer periodes of time.
    \item Handle very low data rate.
    \item Allow for configuration of redelivery delay.
    \item Support usage of HTTP, AMQP and CoAP between proxies.
\end{enumerate}

Next we discuss the design and implementation of our proxy.
