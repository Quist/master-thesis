\chapter{Technical Background}

In this chapter we present concepts and protocols that are central for this
thesis.

We explore challenges a military network has. Next, we discuss common Web
services used for exchanging data in military systems. Then we look into a
number of protocols that we can replace HTTP/TCP with in order to increase the
performance of Web services. We also introduce some common optimization
techniques used to improve network performance. Finally, we present some
available frameworks and solutions for creating a proxy.



\section{Network layers}

To reduce design complexity, networks are organized into layers, each one built
upon the one below it. In the Internet Protocol Suite\cite{rfc-1122}, networks
is divided into 4 layers. As stated in the scope of this thesis, we only look
into optimization techniques for the application and transport layer.

%%%%%%%%%%%% Internet Protocol Suite %%%%%%%%%%%%%%%%%%%
\begin{table}[h]
\begin{tabularx}{\textwidth}{| X |}
\hline
  \textbf{Application Layer} \\ \hline
  \textbf{Transport Layer} \\ \hline
  \textbf{Internet Layer} \\ \hline
  \textbf{Link layer} \\ \hline
\end{tabularx}
\caption{The layers of the Internet Protocol Suite}
\end{table}

\paragraph{Link layer}

The lowest layer is the link layer, where link refers to the to the physical
network component used to interconnect nodes in a network. Link layer protocols
operate between adjacent network nodes. An example of a link layer protocol is
Ethernet.


%%%%%%% WEB SERVICES
\section{Web services}
\label{web-services}
%TO-DO lede inn smooth mot soa.
Web services are client and server applications that communicate over a
network and can be used to implement a service-oriented architecture. Web
services are critical in any data systems and are in widespread use in both
civilian and military systems. It is a broad term and can be used to describe
different types of services that are available over a network. The most common
usage of the term refers to the \gls{w3c} definition of SOAP-based Web
services, but could also refer to more simple HTTP-based \gls{rest} services.

In this thesis we investigate optimization techniques that should support both
\gls{w3c} Web services and \gls{rest}ful web services.

\subsection{W3C Web services}

\gls{w3c} has defined Web Services as \cite{wrc-web-service}:

\paragraph{}
\textit{
    A Web service is a software system designed to support interoperable
    machine-to-machine interaction over a network. It has an interface described in
    a machine-processable format (specifically WSDL). Other systems interact with
    the Web service in a manner prescribed by its description using SOAP-messages,
    typically conveyed using HTTP with an XML serialization in conjunction with
    other Web-related standards.
}

\paragraph{}

This definition points out a set of standards that enables machine-to-machine
interactions. All communication is based on sending XML-based SOAP messages.
It exists many definitions of Web services where the core principles are the
same, but the finer details may vary.  These standards are discussed in the
following sections. The Web Service technology is realization of the \gls{soa}
principles which provides loose coupling and ease integration between systems.

Figur her.


\subsubsection{XML}

The \gls{xml} is considered as the base standard for Web services. An XML
document consist of data surrounded by tags and is designed to be both machine
and user readable. Tags describe the data they enclose. The tags can be
standardized, which allows exchange and understanding of data in a standardized,
machine-readable way.


\subsubsection{Service descriptions: WSDL}

\gls{wsdl} is an interface definition language that using XML describes
functionality offered by a Web Service. The interface describes available
functions, data types for message requests and responses and binding
information about the transport protocol, as well as address information for
locating the service. This enables a formal, machine-readable description of
Web Service which clients can invoke.


\subsubsection{SOAP}

\gls{soap} is an application level XML-based protocol specification for
information exchange in the implementation of Web services. It is transport
protocol agnostic and can be carried over various protocols. The far most used
transport protocol is HTTP over TCP, but other protocols such as UDP and SMTP
can be used as well. A SOAP message is an "envelope" consisting of an optional
header and a required body. The header can contain information not directly
related to the message such as routing information for the message and
security information. The body contains the data being sent, known as the
payload.

\subsubsection{W3C Web Service overhead}

W3C Web services are associated with a considerable amount of overhead. Web
Service technology is based on SOAP, which use XML-based messages. It is a
textual data format and produce much larger messages than binary formats.

% Referere  til IST-090 sluttarpport. IST-090 diskuterer alt.

\subsection{\glsentrylong{rest}}
\label{rest}

There also exist other types of Web services which does not follow the
previously discussed standards. \gls{rest} is an architectural style which let
users manipulate data using a set of stateless operations. It is based on a
client-server model where a client requests data from a server when needed. It
is closely associated with HTTP and use HTTP verbs(e.g GET, POST,
DELETE) to operate on resources on a server.

 \gls{rest} is easy to understand and has gained a lot of traction in the
civil  industry in the latest years. \gls{rest} uses exclusively HTTP over
TCP.  However, TCP does not necessarily perform satisfactorily in \gls{dil}
environments, which limits the usability in tactical networks(trenger kilde?).
It also lack standardization, which may cause interoperability issues.

%Frank tipser om FFI-rapport som kilde. Ref. samtale 14 jan 46:30


\section{\glsentrylong{http}}

As we have seen in the previous section, both restful and w3c Web services
utilizes the \gls{http} as their way to communicate with other services. The
usage of \gls{http} is very widespread and it is the foundation of data
communication for the \glsentrylong{www} since the early 90's. It's protocol
specification is coordinated by \gls{ietf} and the \gls{w3c}, and is defined
as\cite{rfc-2616}:

\paragraph{}
\textit{
    The Hypertext Transfer Protocol (HTTP) is an application-level
    protocol for distributed, collaborative, hypermedia information
    systems. It is a generic, stateless, protocol which can be used for
    many tasks beyond its use for hypertext, such as name servers and
    distributed object management systems, through extension of its
    request methods, error codes and headers
}

\paragraph{}

\gls{http} started out as a simple protocol for raw data transfer across the
Internet and has since been updated in HTTP/1.0, HTTP/1.1 and most recently a
major update with HTTP/2.0. It is a request-reply protocol which means that all
data exchanges is initiated with a client invoking a HTTP-request and then waits
until a server responds with a HTTP response. A HTTP-request consist of the
request method, URI, protocol version, client information, and a optional body.
The server responds with a message containing a status line, protocol version, a
code indicating the success or error of the request, and a optional body. Both
HTTP requests and responses use a generic message format and can contain zero or
more HTTP headers. Headers are used to provide information about the
request/reply or about the message body, e.g information about the encoding and
caching information.

HTTP, being an application level protocol, relies on a transport protocol to
actually transfer data to an another machine. HTTP communication most often, but
not necessarily, occurs over TCP/IP connections. The only requirement is that a
reliable transport protocol is used.

\subsubsection{HTTP methods}
GET, HEAD, POST, PUT, DELETE.


\section{Transport layer}

In the Internet protocol suite model, the transport layer provides end-to-end
communication services for applications\cite{rfc-1122}. The far most used
transport protocol is the \gls{tcp}, which provides reliable transport of data
to applications. With reliable transport we mean that if data in transmission is
lost or received in the wrong order, this is all handled by the transport
protocol. This provides an important abstraction for applications so that they
don't need to deal with the characteristics of the physical network itself.

\subsection{\glsentrylong{tcp}}
\label{tcp}

\gls{tcp} is called the workhorse of the Internet because it is so critical for
how the Internet works. It is the primary transport protocol of the Internet
Protocol Suite\cite{rfc-1122} and provides reliable, in-sequence delivery of
two-way traffic(full-duplex) data.  In this subsection we present the
characteristics of TCP and some of the issues we may encounter working with it.

\gls{tcp} was defined in RFC 793\cite{rfc-793} back in September 1981 and has
since been improved in various RFC's. The main motivation behind \gls{tcp} was
to provide reliable end-to-end byte streams over unreliable networks.

\paragraph{Reliablility}

When transferring data over the Internet, the data may pass through various
networks, routers and physical networks. Some of the routers may be not working
correctly, a bit may be flipped when transferring data wirelessly, or some other
factor may come in to play. For those reasons, we have to accept that some of
the data will be damaged, lost, duplicated or delivered out of order.

TCP recovers from such faults by assigning sequence number to each packet being
sent. It then requires an positive acknowledgement from the receiver that the
data was actually received. If the acknowledgement is not received within a
timeout interval, the data is transmitted again. For the receiver the sequence
numbers are used to ensure that data is received in the correct order, as well
as eliminating duplicates. Furthermore, to detect damaged data, TCP applies
checksums to each segment transmitted. At the receiver the checksum is then
checked and damaged segments are discarded.

\paragraph{Flow Control}

If a fast receiver sends data faster than a slow receiver is able to process,
the receiver will be swamped with data and may experience serious performance
reduction. Flow control is a mechanism to manage the rate of the data
transmission to avoid overflowing a receiver. TCP provides this by using a
window of acceptable sequence numbers that the receiver is willing to accept.
With every acknowledgement sent back to the sender, the window is specified.
This allows the receiver to control which segments, and how fast, the sender
can send.

\paragraph{Connection}

TCP is connection-oriented which means that a connection between a sender and
the receiver must be established before any data can be transfered. A connection
is specified by a pair of sockets identifying its two sides. Associated with
each connection TCP initialize and maintains some status information for each
connection. This includes window size, socket information and sequence numbers.

\paragraph{Protocol}

Computers supporting TCP has a piece of software which manages TCP streams and
interfaces to the IP layer. Most often this software is a part of the
kernel\cite{computer-networks}. It accepts data streams from local processes,
and breaks them up into pieces, before sending them to the IP layer. The pieces
are called TCP segments, which consist of a fixed 20 byte header, followed by
zero or more data byte. The TCP software decide how big the segment should be,
but for performance reasons they should not exceeds the \gls{mtu} of the
link(the physical network). Each segment should be so small that they can be
sent in a single, unfragmented package over the entire network. This usually
limits the size of each segment to the \gls{mtu} of the Ethernet, which is 1500
bytes.

When the TCP software receives data from applications, it is not necessarily
sent imediately as it may be buffered before its sent. At the receiver, data is
delivered to the TCP software, which reconstructs the original byte streams and
deliver them to the target application.


\section{Protocols of interest}

% Trengs en diskjon om NATO's everything over IP her. Man sier det i scope, men
%må diskutere det her.

In order to improve the performance of Web services in \gls{dil} environments we
have investigated the usage of alternative transport protocol other than TCP can
be utilized. In this thesis we're looking into protocols in the transport and
application layer of the Internet Protocol Suite\cite{rfc-1122}.

In the following sections we will give a short introduction to the protocols
we're investigating in this thesis.



\subsection{\glsentrylong{coap}}

\gls{coap} is a specialized web transfer protocol designed for use with
constrained nodes(low power) and constrained networks(lossy)\cite{rfc-7252}. It
is designed for machine-to-machine applications, typically in the Internet of
Things. \gls{coap} was standardized in RFC-7252 as late as in June 2014.

It is based on the REST model, where the server makes resources available  under
a URL. Clients access these resources using the HTTP-verbs GET, PUT, POST and
DELETE. Designed to use minimal resources, both on the device and on the
network.

\begin{itemize}
    \item Application level protocol.
    \item Can carry any data format.
    \item UDP on IP.
    \item Simple binary base header format
\end{itemize}


\subsection{\glsentrylong{amqp}}

\gls{amqp} is a messaging middleware that can utilize different transport
protocols.

\begin{itemize}
    \item Support both request/response and publish/subscribe communication
    paradigms.
    \item Reliable when facing network disruptions, since it employs a
    broker-based architecture with store-and-forward capabilities.
\end{itemize}

\subsection{\glsentrylong{mqtt}}

MQTT is a client server publish/subscribe messaging transport protocol
\cite{oasis-mqtt}. It is considered lightweight and is designed for use in networks
where the bandwidth is limited. It is broker-based, where the broker is
responsible for delivering messages to clients based on the topic of a
message.

\subsection{\glsentrylong{sctp}}

\gls{sctp} is transport-layer protocol which offers functionality from both \gls{udp} and \gls{tcp}.
\begin{itemize}
    \item Message-oriented like UDP.
    \item Ensure reliable, in sequence transport of messages with congestion control like TCP.
    \item Multi-homing and multi-streaming.
\end{itemize}



\subsection{UDP}
WSReliability? For rest må det da bygges inn støtte i proxien.
Reliable UDP. Implmentasjon av UDP som er reliable. En gammel protokoll?
\begin{itemize}
    \item No mechanisms for flow control, packet ordering or integrity of
    messages.
\end{itemize}

\section{Proxies}

A proxy is an application which acts as an intermediary between an client and a
server. Proxies are widely in use and their usage and type varies. Example of
usage is load balancing, caching and security. Web proxies are proxies that
forward HTTP requests, which is what we are investigating in this thesis.

In this section we will briefly present available popular web proxies.

\subsection{Apache}

\subsection{Squid}

\subsection{Apache Camel}

This does the work of converting the specific input/request (like an HTTP
request) into something generic - a Camel Exchange - that can travel down a
Route.
 - quoute. må skrives om.

\subsection{Nginx}


\section{Summary}


%%%%%%%%%%%% Transport protokoller %%%%%%%%%%%%%%%%%%%
\begin{table}[h]
\begin{tabularx}{\textwidth}{| X | X |}
\hline
  \textbf{Protocol} & \textbf{Summary} \\ \hline
  HTTP over TCP & Widely used. Breaks down in DIL environments.\\ \hline
  CoAP & Application level protocol designed for use in the Internet of Things. \\ \hline
  AMQP & Messaging middleware with store-and-forward capabilities.\\ \hline
  MQTT & Summary here\\ \hline
  SCTP & Similar to UDP but also provide reliable, in sequence transport of messages like TCP. \\ \hline
  TCP & The well-known transport protocol. \\ \hline
  UDP & Lacks reliability, but frameworks exist that provides it. \\ \hline
\end{tabularx}
\caption{Protocols of Interest}
\end{table}
